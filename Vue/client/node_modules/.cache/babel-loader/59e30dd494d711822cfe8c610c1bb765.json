{"ast":null,"code":"import _objectSpread from \"D:/Stage/App/xr-place-application/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/web.timers.js\";\n// Utilities\nimport { getCurrentInstance, propsFactory } from \"../util/index.mjs\";\nimport { computed, onBeforeUnmount, onMounted, resolveDynamicComponent, toRef } from 'vue'; // Types\n\nexport function useRoute() {\n  var vm = getCurrentInstance('useRoute');\n  return computed(function () {\n    var _vm$proxy;\n\n    return vm == null ? void 0 : (_vm$proxy = vm.proxy) == null ? void 0 : _vm$proxy.$route;\n  });\n}\nexport function useRouter() {\n  var _getCurrentInstance, _getCurrentInstance$p;\n\n  return (_getCurrentInstance = getCurrentInstance('useRouter')) == null ? void 0 : (_getCurrentInstance$p = _getCurrentInstance.proxy) == null ? void 0 : _getCurrentInstance$p.$router;\n}\nexport function useLink(props, attrs) {\n  var RouterLink = resolveDynamicComponent('RouterLink');\n  var isLink = computed(function () {\n    return !!(props.href || props.to);\n  });\n  var isClickable = computed(function () {\n    return (isLink == null ? void 0 : isLink.value) || !!(attrs.onClick || attrs.onClickOnce);\n  });\n\n  if (typeof RouterLink === 'string') {\n    return {\n      isLink: isLink,\n      isClickable: isClickable,\n      href: toRef(props, 'href')\n    };\n  }\n\n  var link = props.to ? RouterLink.useLink(props) : undefined;\n  return _objectSpread(_objectSpread({}, link), {}, {\n    isLink: isLink,\n    isClickable: isClickable,\n    href: computed(function () {\n      return props.to ? link == null ? void 0 : link.route.value.href : props.href;\n    })\n  });\n}\nexport var makeRouterProps = propsFactory({\n  href: String,\n  replace: Boolean,\n  to: [String, Object]\n}, 'router');\nexport function useBackButton(cb) {\n  var router = useRouter();\n  var popped = false;\n  var removeGuard;\n  onMounted(function () {\n    window.addEventListener('popstate', onPopstate);\n    removeGuard = router == null ? void 0 : router.beforeEach(function (to, from, next) {\n      setTimeout(function () {\n        return popped ? cb(next) : next();\n      });\n    });\n  });\n  onBeforeUnmount(function () {\n    var _removeGuard;\n\n    window.removeEventListener('popstate', onPopstate);\n    (_removeGuard = removeGuard) == null ? void 0 : _removeGuard();\n  });\n\n  function onPopstate(e) {\n    var _e$state;\n\n    if ((_e$state = e.state) != null && _e$state.replaced) return;\n    popped = true;\n    setTimeout(function () {\n      return popped = false;\n    });\n  }\n}","map":{"version":3,"mappings":"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","names":["getCurrentInstance","propsFactory","computed","onBeforeUnmount","onMounted","resolveDynamicComponent","toRef","useRoute","vm","proxy","_vm$proxy","$route","useRouter","_getCurrentInstance","_getCurrentInstance$p","$router","useLink","props","attrs","RouterLink","isLink","href","to","isClickable","value","onClick","onClickOnce","link","undefined","route","makeRouterProps","String","replace","Boolean","Object","useBackButton","cb","router","popped","removeGuard","window","addEventListener","onPopstate","beforeEach","from","next","setTimeout","removeEventListener","e","state","_e$state","replaced"],"sources":["../../src/composables/router.tsx"],"sourcesContent":["// Utilities\nimport { getCurrentInstance, propsFactory } from '@/util'\nimport {\n  computed,\n  onBeforeUnmount,\n  onMounted,\n  resolveDynamicComponent,\n  toRef,\n} from 'vue'\n\n// Types\nimport type { ComputedRef, PropType, Ref, SetupContext } from 'vue'\nimport type {\n  RouterLink as _RouterLink,\n  useLink as _useLink,\n  NavigationGuardNext,\n  RouteLocationNormalizedLoaded,\n  RouteLocationRaw,\n  Router,\n} from 'vue-router'\n\nexport function useRoute (): Ref<RouteLocationNormalizedLoaded | undefined> {\n  const vm = getCurrentInstance('useRoute')\n\n  return computed(() => vm?.proxy?.$route)\n}\n\nexport function useRouter (): Router | undefined {\n  return getCurrentInstance('useRouter')?.proxy?.$router\n}\n\nexport interface LinkProps {\n  href?: string\n  replace?: boolean\n  to?: RouteLocationRaw\n}\n\nexport interface UseLink extends Omit<Partial<ReturnType<typeof _useLink>>, 'href'> {\n  isLink: ComputedRef<boolean>\n  isClickable: ComputedRef<boolean>\n  href: Ref<string | undefined>\n}\n\nexport function useLink (props: LinkProps, attrs: SetupContext['attrs']): UseLink {\n  const RouterLink = resolveDynamicComponent('RouterLink') as typeof _RouterLink | string\n\n  const isLink = computed(() => !!(props.href || props.to))\n  const isClickable = computed(() => {\n    return isLink?.value || !!(attrs.onClick || attrs.onClickOnce)\n  })\n\n  if (typeof RouterLink === 'string') {\n    return {\n      isLink,\n      isClickable,\n      href: toRef(props, 'href'),\n    }\n  }\n\n  const link = props.to ? RouterLink.useLink(props as Required<LinkProps>) : undefined\n\n  return {\n    ...link,\n    isLink,\n    isClickable,\n    href: computed(() => props.to ? link?.route.value.href : props.href),\n  }\n}\n\nexport const makeRouterProps = propsFactory({\n  href: String,\n  replace: Boolean,\n  to: [String, Object] as PropType<RouteLocationRaw>,\n}, 'router')\n\nexport function useBackButton (cb: (next: NavigationGuardNext) => void) {\n  const router = useRouter()\n  let popped = false\n  let removeGuard: (() => void) | undefined\n\n  onMounted(() => {\n    window.addEventListener('popstate', onPopstate)\n    removeGuard = router?.beforeEach((to, from, next) => {\n      setTimeout(() => popped ? cb(next) : next())\n    })\n  })\n  onBeforeUnmount(() => {\n    window.removeEventListener('popstate', onPopstate)\n    removeGuard?.()\n  })\n\n  function onPopstate (e: PopStateEvent) {\n    if (e.state?.replaced) return\n\n    popped = true\n    setTimeout(() => (popped = false))\n  }\n}\n"]},"metadata":{},"sourceType":"module"}