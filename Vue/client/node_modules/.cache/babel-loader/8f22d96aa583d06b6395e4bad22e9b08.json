{"ast":null,"code":"/**\n * Allows smooth kinetic scrolling of the surface\n */\nmodule.exports = kinetic;\n\nfunction kinetic(getPoint, scroll, settings) {\n  if (typeof settings !== 'object') {\n    // setting could come as boolean, we should ignore it, and use an object.\n    settings = {};\n  }\n\n  var minVelocity = typeof settings.minVelocity === 'number' ? settings.minVelocity : 5;\n  var amplitude = typeof settings.amplitude === 'number' ? settings.amplitude : 0.25;\n  var cancelAnimationFrame = typeof settings.cancelAnimationFrame === 'function' ? settings.cancelAnimationFrame : getCancelAnimationFrame();\n  var requestAnimationFrame = typeof settings.requestAnimationFrame === 'function' ? settings.requestAnimationFrame : getRequestAnimationFrame();\n  var lastPoint;\n  var timestamp;\n  var timeConstant = 342;\n  var ticker;\n  var vx, targetX, ax;\n  var vy, targetY, ay;\n  var raf;\n  return {\n    start: start,\n    stop: stop,\n    cancel: dispose\n  };\n\n  function dispose() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n  }\n\n  function start() {\n    lastPoint = getPoint();\n    ax = ay = vx = vy = 0;\n    timestamp = new Date();\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf); // we start polling the point position to accumulate velocity\n    // Once we stop(), we will use accumulated velocity to keep scrolling\n    // an object.\n\n    ticker = requestAnimationFrame(track);\n  }\n\n  function track() {\n    var now = Date.now();\n    var elapsed = now - timestamp;\n    timestamp = now;\n    var currentPoint = getPoint();\n    var dx = currentPoint.x - lastPoint.x;\n    var dy = currentPoint.y - lastPoint.y;\n    lastPoint = currentPoint;\n    var dt = 1000 / (1 + elapsed); // moving average\n\n    vx = 0.8 * dx * dt + 0.2 * vx;\n    vy = 0.8 * dy * dt + 0.2 * vy;\n    ticker = requestAnimationFrame(track);\n  }\n\n  function stop() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n    var currentPoint = getPoint();\n    targetX = currentPoint.x;\n    targetY = currentPoint.y;\n    timestamp = Date.now();\n\n    if (vx < -minVelocity || vx > minVelocity) {\n      ax = amplitude * vx;\n      targetX += ax;\n    }\n\n    if (vy < -minVelocity || vy > minVelocity) {\n      ay = amplitude * vy;\n      targetY += ay;\n    }\n\n    raf = requestAnimationFrame(autoScroll);\n  }\n\n  function autoScroll() {\n    var elapsed = Date.now() - timestamp;\n    var moving = false;\n    var dx = 0;\n    var dy = 0;\n\n    if (ax) {\n      dx = -ax * Math.exp(-elapsed / timeConstant);\n      if (dx > 0.5 || dx < -0.5) moving = true;else dx = ax = 0;\n    }\n\n    if (ay) {\n      dy = -ay * Math.exp(-elapsed / timeConstant);\n      if (dy > 0.5 || dy < -0.5) moving = true;else dy = ay = 0;\n    }\n\n    if (moving) {\n      scroll(targetX + dx, targetY + dy);\n      raf = requestAnimationFrame(autoScroll);\n    }\n  }\n}\n\nfunction getCancelAnimationFrame() {\n  if (typeof cancelAnimationFrame === 'function') return cancelAnimationFrame;\n  return clearTimeout;\n}\n\nfunction getRequestAnimationFrame() {\n  if (typeof requestAnimationFrame === 'function') return requestAnimationFrame;\n  return function (handler) {\n    return setTimeout(handler, 16);\n  };\n}","map":{"version":3,"sources":["C:/Users/apuyo/OneDrive/Bureau/cours/projetsWeb_DUT_AntoinePuyol/Vue/client/node_modules/panzoom/lib/kinetic.js"],"names":["module","exports","kinetic","getPoint","scroll","settings","minVelocity","amplitude","cancelAnimationFrame","getCancelAnimationFrame","requestAnimationFrame","getRequestAnimationFrame","lastPoint","timestamp","timeConstant","ticker","vx","targetX","ax","vy","targetY","ay","raf","start","stop","cancel","dispose","Date","track","now","elapsed","currentPoint","dx","x","dy","y","dt","autoScroll","moving","Math","exp","clearTimeout","handler","setTimeout"],"mappings":"AAAA;AACA;AACA;AACAA,MAAM,CAACC,OAAP,GAAiBC,OAAjB;;AAEA,SAASA,OAAT,CAAiBC,QAAjB,EAA2BC,MAA3B,EAAmCC,QAAnC,EAA6C;AAC3C,MAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC;AAChC;AACAA,IAAAA,QAAQ,GAAG,EAAX;AACD;;AAED,MAAIC,WAAW,GAAG,OAAOD,QAAQ,CAACC,WAAhB,KAAgC,QAAhC,GAA2CD,QAAQ,CAACC,WAApD,GAAkE,CAApF;AACA,MAAIC,SAAS,GAAG,OAAOF,QAAQ,CAACE,SAAhB,KAA8B,QAA9B,GAAyCF,QAAQ,CAACE,SAAlD,GAA8D,IAA9E;AACA,MAAIC,oBAAoB,GAAG,OAAOH,QAAQ,CAACG,oBAAhB,KAAyC,UAAzC,GAAsDH,QAAQ,CAACG,oBAA/D,GAAsFC,uBAAuB,EAAxI;AACA,MAAIC,qBAAqB,GAAG,OAAOL,QAAQ,CAACK,qBAAhB,KAA0C,UAA1C,GAAuDL,QAAQ,CAACK,qBAAhE,GAAwFC,wBAAwB,EAA5I;AAEA,MAAIC,SAAJ;AACA,MAAIC,SAAJ;AACA,MAAIC,YAAY,GAAG,GAAnB;AAEA,MAAIC,MAAJ;AACA,MAAIC,EAAJ,EAAQC,OAAR,EAAiBC,EAAjB;AACA,MAAIC,EAAJ,EAAQC,OAAR,EAAiBC,EAAjB;AAEA,MAAIC,GAAJ;AAEA,SAAO;AACLC,IAAAA,KAAK,EAAEA,KADF;AAELC,IAAAA,IAAI,EAAEA,IAFD;AAGLC,IAAAA,MAAM,EAAEC;AAHH,GAAP;;AAMA,WAASA,OAAT,GAAmB;AACjBlB,IAAAA,oBAAoB,CAACO,MAAD,CAApB;AACAP,IAAAA,oBAAoB,CAACc,GAAD,CAApB;AACD;;AAED,WAASC,KAAT,GAAiB;AACfX,IAAAA,SAAS,GAAGT,QAAQ,EAApB;AAEAe,IAAAA,EAAE,GAAGG,EAAE,GAAGL,EAAE,GAAGG,EAAE,GAAG,CAApB;AACAN,IAAAA,SAAS,GAAG,IAAIc,IAAJ,EAAZ;AAEAnB,IAAAA,oBAAoB,CAACO,MAAD,CAApB;AACAP,IAAAA,oBAAoB,CAACc,GAAD,CAApB,CAPe,CASf;AACA;AACA;;AACAP,IAAAA,MAAM,GAAGL,qBAAqB,CAACkB,KAAD,CAA9B;AACD;;AAED,WAASA,KAAT,GAAiB;AACf,QAAIC,GAAG,GAAGF,IAAI,CAACE,GAAL,EAAV;AACA,QAAIC,OAAO,GAAGD,GAAG,GAAGhB,SAApB;AACAA,IAAAA,SAAS,GAAGgB,GAAZ;AAEA,QAAIE,YAAY,GAAG5B,QAAQ,EAA3B;AAEA,QAAI6B,EAAE,GAAGD,YAAY,CAACE,CAAb,GAAiBrB,SAAS,CAACqB,CAApC;AACA,QAAIC,EAAE,GAAGH,YAAY,CAACI,CAAb,GAAiBvB,SAAS,CAACuB,CAApC;AAEAvB,IAAAA,SAAS,GAAGmB,YAAZ;AAEA,QAAIK,EAAE,GAAG,QAAQ,IAAIN,OAAZ,CAAT,CAZe,CAcf;;AACAd,IAAAA,EAAE,GAAG,MAAMgB,EAAN,GAAWI,EAAX,GAAgB,MAAMpB,EAA3B;AACAG,IAAAA,EAAE,GAAG,MAAMe,EAAN,GAAWE,EAAX,GAAgB,MAAMjB,EAA3B;AAEAJ,IAAAA,MAAM,GAAGL,qBAAqB,CAACkB,KAAD,CAA9B;AACD;;AAED,WAASJ,IAAT,GAAgB;AACdhB,IAAAA,oBAAoB,CAACO,MAAD,CAApB;AACAP,IAAAA,oBAAoB,CAACc,GAAD,CAApB;AAEA,QAAIS,YAAY,GAAG5B,QAAQ,EAA3B;AAEAc,IAAAA,OAAO,GAAGc,YAAY,CAACE,CAAvB;AACAb,IAAAA,OAAO,GAAGW,YAAY,CAACI,CAAvB;AACAtB,IAAAA,SAAS,GAAGc,IAAI,CAACE,GAAL,EAAZ;;AAEA,QAAIb,EAAE,GAAG,CAACV,WAAN,IAAqBU,EAAE,GAAGV,WAA9B,EAA2C;AACzCY,MAAAA,EAAE,GAAGX,SAAS,GAAGS,EAAjB;AACAC,MAAAA,OAAO,IAAIC,EAAX;AACD;;AAED,QAAIC,EAAE,GAAG,CAACb,WAAN,IAAqBa,EAAE,GAAGb,WAA9B,EAA2C;AACzCe,MAAAA,EAAE,GAAGd,SAAS,GAAGY,EAAjB;AACAC,MAAAA,OAAO,IAAIC,EAAX;AACD;;AAEDC,IAAAA,GAAG,GAAGZ,qBAAqB,CAAC2B,UAAD,CAA3B;AACD;;AAED,WAASA,UAAT,GAAsB;AACpB,QAAIP,OAAO,GAAGH,IAAI,CAACE,GAAL,KAAahB,SAA3B;AAEA,QAAIyB,MAAM,GAAG,KAAb;AACA,QAAIN,EAAE,GAAG,CAAT;AACA,QAAIE,EAAE,GAAG,CAAT;;AAEA,QAAIhB,EAAJ,EAAQ;AACNc,MAAAA,EAAE,GAAG,CAACd,EAAD,GAAMqB,IAAI,CAACC,GAAL,CAAS,CAACV,OAAD,GAAWhB,YAApB,CAAX;AAEA,UAAIkB,EAAE,GAAG,GAAL,IAAYA,EAAE,GAAG,CAAC,GAAtB,EAA2BM,MAAM,GAAG,IAAT,CAA3B,KACKN,EAAE,GAAGd,EAAE,GAAG,CAAV;AACN;;AAED,QAAIG,EAAJ,EAAQ;AACNa,MAAAA,EAAE,GAAG,CAACb,EAAD,GAAMkB,IAAI,CAACC,GAAL,CAAS,CAACV,OAAD,GAAWhB,YAApB,CAAX;AAEA,UAAIoB,EAAE,GAAG,GAAL,IAAYA,EAAE,GAAG,CAAC,GAAtB,EAA2BI,MAAM,GAAG,IAAT,CAA3B,KACKJ,EAAE,GAAGb,EAAE,GAAG,CAAV;AACN;;AAED,QAAIiB,MAAJ,EAAY;AACVlC,MAAAA,MAAM,CAACa,OAAO,GAAGe,EAAX,EAAeZ,OAAO,GAAGc,EAAzB,CAAN;AACAZ,MAAAA,GAAG,GAAGZ,qBAAqB,CAAC2B,UAAD,CAA3B;AACD;AACF;AACF;;AAED,SAAS5B,uBAAT,GAAmC;AACjC,MAAI,OAAOD,oBAAP,KAAgC,UAApC,EAAgD,OAAOA,oBAAP;AAChD,SAAOiC,YAAP;AACD;;AAED,SAAS9B,wBAAT,GAAoC;AAClC,MAAI,OAAOD,qBAAP,KAAiC,UAArC,EAAiD,OAAOA,qBAAP;AAEjD,SAAO,UAAUgC,OAAV,EAAmB;AACxB,WAAOC,UAAU,CAACD,OAAD,EAAU,EAAV,CAAjB;AACD,GAFD;AAGD","sourcesContent":["/**\n * Allows smooth kinetic scrolling of the surface\n */\nmodule.exports = kinetic;\n\nfunction kinetic(getPoint, scroll, settings) {\n  if (typeof settings !== 'object') {\n    // setting could come as boolean, we should ignore it, and use an object.\n    settings = {};\n  }\n\n  var minVelocity = typeof settings.minVelocity === 'number' ? settings.minVelocity : 5;\n  var amplitude = typeof settings.amplitude === 'number' ? settings.amplitude : 0.25;\n  var cancelAnimationFrame = typeof settings.cancelAnimationFrame === 'function' ? settings.cancelAnimationFrame : getCancelAnimationFrame();\n  var requestAnimationFrame = typeof settings.requestAnimationFrame === 'function' ? settings.requestAnimationFrame : getRequestAnimationFrame();\n\n  var lastPoint;\n  var timestamp;\n  var timeConstant = 342;\n\n  var ticker;\n  var vx, targetX, ax;\n  var vy, targetY, ay;\n\n  var raf;\n\n  return {\n    start: start,\n    stop: stop,\n    cancel: dispose\n  };\n\n  function dispose() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n  }\n\n  function start() {\n    lastPoint = getPoint();\n\n    ax = ay = vx = vy = 0;\n    timestamp = new Date();\n\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    // we start polling the point position to accumulate velocity\n    // Once we stop(), we will use accumulated velocity to keep scrolling\n    // an object.\n    ticker = requestAnimationFrame(track);\n  }\n\n  function track() {\n    var now = Date.now();\n    var elapsed = now - timestamp;\n    timestamp = now;\n\n    var currentPoint = getPoint();\n\n    var dx = currentPoint.x - lastPoint.x;\n    var dy = currentPoint.y - lastPoint.y;\n\n    lastPoint = currentPoint;\n\n    var dt = 1000 / (1 + elapsed);\n\n    // moving average\n    vx = 0.8 * dx * dt + 0.2 * vx;\n    vy = 0.8 * dy * dt + 0.2 * vy;\n\n    ticker = requestAnimationFrame(track);\n  }\n\n  function stop() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    var currentPoint = getPoint();\n\n    targetX = currentPoint.x;\n    targetY = currentPoint.y;\n    timestamp = Date.now();\n\n    if (vx < -minVelocity || vx > minVelocity) {\n      ax = amplitude * vx;\n      targetX += ax;\n    }\n\n    if (vy < -minVelocity || vy > minVelocity) {\n      ay = amplitude * vy;\n      targetY += ay;\n    }\n\n    raf = requestAnimationFrame(autoScroll);\n  }\n\n  function autoScroll() {\n    var elapsed = Date.now() - timestamp;\n\n    var moving = false;\n    var dx = 0;\n    var dy = 0;\n\n    if (ax) {\n      dx = -ax * Math.exp(-elapsed / timeConstant);\n\n      if (dx > 0.5 || dx < -0.5) moving = true;\n      else dx = ax = 0;\n    }\n\n    if (ay) {\n      dy = -ay * Math.exp(-elapsed / timeConstant);\n\n      if (dy > 0.5 || dy < -0.5) moving = true;\n      else dy = ay = 0;\n    }\n\n    if (moving) {\n      scroll(targetX + dx, targetY + dy);\n      raf = requestAnimationFrame(autoScroll);\n    }\n  }\n}\n\nfunction getCancelAnimationFrame() {\n  if (typeof cancelAnimationFrame === 'function') return cancelAnimationFrame;\n  return clearTimeout;\n}\n\nfunction getRequestAnimationFrame() {\n  if (typeof requestAnimationFrame === 'function') return requestAnimationFrame;\n\n  return function (handler) {\n    return setTimeout(handler, 16);\n  };\n}"]},"metadata":{},"sourceType":"script"}