{"ast":null,"code":"import _slicedToArray from \"D:/Stage/App/xr-place-application/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _objectSpread from \"D:/Stage/App/xr-place-application/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.keys.js\";\n// Utilities\nimport { getCurrentInstance, IN_BROWSER, isComponentInstance, propsFactory, SUPPORTS_FOCUS_VISIBLE } from \"../../util/index.mjs\";\nimport { makeDelayProps, useDelay } from \"../../composables/delay.mjs\";\nimport { computed, effectScope, nextTick, onScopeDispose, ref, watch, watchEffect } from 'vue'; // Types\n\nexport var makeActivatorProps = propsFactory(_objectSpread({\n  activator: [String, Object],\n  activatorProps: {\n    type: Object,\n    \"default\": function _default() {\n      return {};\n    }\n  },\n  openOnClick: {\n    type: Boolean,\n    \"default\": undefined\n  },\n  openOnHover: Boolean,\n  openOnFocus: {\n    type: Boolean,\n    \"default\": undefined\n  }\n}, makeDelayProps()));\nexport function useActivator(props, isActive) {\n  var activatorEl = ref();\n  var isHovered = false;\n  var isFocused = false;\n  var openOnFocus = computed(function () {\n    return props.openOnFocus || props.openOnFocus == null && props.openOnHover;\n  });\n  var openOnClick = computed(function () {\n    return props.openOnClick || props.openOnClick == null && !props.openOnHover && !openOnFocus.value;\n  });\n\n  var _useDelay = useDelay(props, function (value) {\n    if (value === (props.openOnHover && isHovered || openOnFocus.value && isFocused)) {\n      isActive.value = value;\n    }\n  }),\n      runOpenDelay = _useDelay.runOpenDelay,\n      runCloseDelay = _useDelay.runCloseDelay;\n\n  var availableEvents = {\n    click: function click(e) {\n      e.stopPropagation();\n      activatorEl.value = e.currentTarget || e.target;\n      isActive.value = !isActive.value;\n    },\n    mouseenter: function mouseenter(e) {\n      isHovered = true;\n      activatorEl.value = e.currentTarget || e.target;\n      runOpenDelay();\n    },\n    mouseleave: function mouseleave(e) {\n      isHovered = false;\n      runCloseDelay();\n    },\n    focus: function focus(e) {\n      if (SUPPORTS_FOCUS_VISIBLE && !e.target.matches(':focus-visible')) return;\n      isFocused = true;\n      e.stopPropagation();\n      activatorEl.value = e.currentTarget || e.target;\n      runOpenDelay();\n    },\n    blur: function blur(e) {\n      isFocused = false;\n      e.stopPropagation();\n      runCloseDelay();\n    }\n  };\n  var activatorEvents = computed(function () {\n    var events = {};\n\n    if (openOnClick.value) {\n      events.click = availableEvents.click;\n    }\n\n    if (props.openOnHover) {\n      events.mouseenter = availableEvents.mouseenter;\n      events.mouseleave = availableEvents.mouseleave;\n    }\n\n    if (openOnFocus.value) {\n      events.focus = availableEvents.focus;\n      events.blur = availableEvents.blur;\n    }\n\n    return events;\n  });\n  var activatorRef = ref();\n  watchEffect(function () {\n    if (!activatorRef.value) return;\n    nextTick(function () {\n      var activator = activatorRef.value;\n      activatorEl.value = isComponentInstance(activator) ? activator.$el : activator;\n    });\n  });\n  var vm = getCurrentInstance('useActivator');\n  var scope;\n  watch(function () {\n    return !!props.activator;\n  }, function (val) {\n    if (val && IN_BROWSER) {\n      scope = effectScope();\n      scope.run(function () {\n        _useActivator(props, vm, {\n          activatorEl: activatorEl,\n          activatorRef: activatorRef,\n          activatorEvents: activatorEvents\n        });\n      });\n    } else if (scope) {\n      scope.stop();\n    }\n  }, {\n    flush: 'post',\n    immediate: true\n  });\n  return {\n    activatorEl: activatorEl,\n    activatorRef: activatorRef,\n    activatorEvents: activatorEvents\n  };\n}\n\nfunction _useActivator(props, vm, _ref) {\n  var activatorEl = _ref.activatorEl,\n      activatorEvents = _ref.activatorEvents;\n  watch(function () {\n    return props.activator;\n  }, function (val, oldVal) {\n    if (oldVal && val !== oldVal) {\n      var activator = getActivator(oldVal);\n      activator && unbindActivatorProps(activator);\n    }\n\n    if (val) {\n      nextTick(function () {\n        return bindActivatorProps();\n      });\n    }\n  }, {\n    immediate: true\n  });\n  watch(function () {\n    return props.activatorProps;\n  }, function () {\n    bindActivatorProps();\n  });\n  onScopeDispose(function () {\n    unbindActivatorProps();\n  });\n\n  function bindActivatorProps() {\n    var el = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getActivator();\n\n    var _props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : props.activatorProps;\n\n    if (!el) return;\n    Object.entries(activatorEvents.value).forEach(function (_ref2) {\n      var _ref4 = _slicedToArray(_ref2, 2),\n          name = _ref4[0],\n          cb = _ref4[1];\n\n      el.addEventListener(name, cb);\n    });\n    Object.keys(_props).forEach(function (k) {\n      if (_props[k] == null) {\n        el.removeAttribute(k);\n      } else {\n        el.setAttribute(k, _props[k]);\n      }\n    });\n  }\n\n  function unbindActivatorProps() {\n    var el = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getActivator();\n\n    var _props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : props.activatorProps;\n\n    if (!el) return;\n    Object.entries(activatorEvents.value).forEach(function (_ref3) {\n      var _ref5 = _slicedToArray(_ref3, 2),\n          name = _ref5[0],\n          cb = _ref5[1];\n\n      el.removeEventListener(name, cb);\n    });\n    Object.keys(_props).forEach(function (k) {\n      el.removeAttribute(k);\n    });\n  }\n\n  function getActivator() {\n    var _activator;\n\n    var selector = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : props.activator;\n    var activator;\n\n    if (selector) {\n      if (selector === 'parent') {\n        var _vm$proxy, _vm$proxy$$el;\n\n        activator = vm == null ? void 0 : (_vm$proxy = vm.proxy) == null ? void 0 : (_vm$proxy$$el = _vm$proxy.$el) == null ? void 0 : _vm$proxy$$el.parentNode;\n      } else if (typeof selector === 'string') {\n        // Selector\n        activator = document.querySelector(selector);\n      } else if ('$el' in selector) {\n        // Component (ref)\n        activator = selector.$el;\n      } else {\n        // HTMLElement | Element\n        activator = selector;\n      }\n    } // The activator should only be a valid element (Ignore comments and text nodes)\n\n\n    activatorEl.value = ((_activator = activator) == null ? void 0 : _activator.nodeType) === Node.ELEMENT_NODE ? activator : null;\n    return activatorEl.value;\n  }\n}","map":{"version":3,"mappings":"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","names":["getCurrentInstance","IN_BROWSER","isComponentInstance","propsFactory","SUPPORTS_FOCUS_VISIBLE","makeDelayProps","useDelay","computed","effectScope","nextTick","onScopeDispose","ref","watch","watchEffect","makeActivatorProps","activator","String","Object","activatorProps","type","default","openOnClick","Boolean","undefined","openOnHover","openOnFocus","useActivator","props","isActive","activatorEl","isHovered","isFocused","value","runOpenDelay","runCloseDelay","availableEvents","click","e","stopPropagation","currentTarget","target","mouseenter","mouseleave","focus","matches","blur","activatorEvents","events","activatorRef","$el","vm","scope","val","run","_useActivator","stop","flush","immediate","oldVal","getActivator","unbindActivatorProps","bindActivatorProps","el","_props","entries","forEach","name","cb","addEventListener","keys","k","removeAttribute","setAttribute","removeEventListener","selector","proxy","_vm$proxy","_vm$proxy$$el","parentNode","document","querySelector","nodeType","Node","ELEMENT_NODE"],"sources":["../../../src/components/VOverlay/useActivator.tsx"],"sourcesContent":["// Utilities\nimport { getCurrentInstance, IN_BROWSER, isComponentInstance, propsFactory, SUPPORTS_FOCUS_VISIBLE } from '@/util'\nimport { makeDelayProps, useDelay } from '@/composables/delay'\nimport {\n  computed,\n  effectScope,\n  nextTick,\n  onScopeDispose,\n  ref,\n  watch,\n  watchEffect,\n} from 'vue'\n\n// Types\nimport type { DelayProps } from '@/composables/delay'\nimport type {\n  ComponentInternalInstance,\n  ComponentPublicInstance,\n  EffectScope,\n  PropType,\n\n  Ref,\n} from 'vue'\n\ninterface ActivatorProps extends DelayProps {\n  activator?: 'parent' | string | Element | ComponentPublicInstance\n  activatorProps: Record<string, any>\n\n  openOnClick: boolean | undefined\n  openOnHover: boolean\n  openOnFocus: boolean | undefined\n}\n\nexport const makeActivatorProps = propsFactory({\n  activator: [String, Object] as PropType<ActivatorProps['activator']>,\n  activatorProps: {\n    type: Object as PropType<ActivatorProps['activatorProps']>,\n    default: () => ({}),\n  },\n\n  openOnClick: {\n    type: Boolean,\n    default: undefined,\n  },\n  openOnHover: Boolean,\n  openOnFocus: {\n    type: Boolean,\n    default: undefined,\n  },\n\n  ...makeDelayProps(),\n})\n\nexport function useActivator (\n  props: ActivatorProps,\n  isActive: Ref<boolean>\n) {\n  const activatorEl = ref<HTMLElement>()\n\n  let isHovered = false\n  let isFocused = false\n\n  const openOnFocus = computed(() => props.openOnFocus || (props.openOnFocus == null && props.openOnHover))\n  const openOnClick = computed(() => props.openOnClick || (props.openOnClick == null && !props.openOnHover && !openOnFocus.value))\n\n  const { runOpenDelay, runCloseDelay } = useDelay(props, value => {\n    if (value === (\n      (props.openOnHover && isHovered) ||\n      (openOnFocus.value && isFocused)\n    )) {\n      isActive.value = value\n    }\n  })\n\n  const availableEvents = {\n    click: (e: MouseEvent) => {\n      e.stopPropagation()\n      activatorEl.value = (e.currentTarget || e.target) as HTMLElement\n      isActive.value = !isActive.value\n    },\n    mouseenter: (e: MouseEvent) => {\n      isHovered = true\n      activatorEl.value = (e.currentTarget || e.target) as HTMLElement\n      runOpenDelay()\n    },\n    mouseleave: (e: MouseEvent) => {\n      isHovered = false\n      runCloseDelay()\n    },\n    focus: (e: FocusEvent) => {\n      if (\n        SUPPORTS_FOCUS_VISIBLE &&\n        !(e.target as HTMLElement).matches(':focus-visible')\n      ) return\n\n      isFocused = true\n      e.stopPropagation()\n      activatorEl.value = (e.currentTarget || e.target) as HTMLElement\n\n      runOpenDelay()\n    },\n    blur: (e: FocusEvent) => {\n      isFocused = false\n      e.stopPropagation()\n\n      runCloseDelay()\n    },\n  }\n\n  const activatorEvents = computed(() => {\n    const events: Partial<typeof availableEvents> = {}\n\n    if (openOnClick.value) {\n      events.click = availableEvents.click\n    }\n    if (props.openOnHover) {\n      events.mouseenter = availableEvents.mouseenter\n      events.mouseleave = availableEvents.mouseleave\n    }\n    if (openOnFocus.value) {\n      events.focus = availableEvents.focus\n      events.blur = availableEvents.blur\n    }\n\n    return events\n  })\n\n  const activatorRef = ref()\n  watchEffect(() => {\n    if (!activatorRef.value) return\n\n    nextTick(() => {\n      const activator = activatorRef.value\n      activatorEl.value = isComponentInstance(activator) ? activator.$el : activator\n    })\n  })\n\n  const vm = getCurrentInstance('useActivator')\n  let scope: EffectScope\n  watch(() => !!props.activator, val => {\n    if (val && IN_BROWSER) {\n      scope = effectScope()\n      scope.run(() => {\n        _useActivator(props, vm, { activatorEl, activatorRef, activatorEvents })\n      })\n    } else if (scope) {\n      scope.stop()\n    }\n  }, { flush: 'post', immediate: true })\n\n  return { activatorEl, activatorRef, activatorEvents }\n}\n\nfunction _useActivator (\n  props: ActivatorProps,\n  vm: ComponentInternalInstance,\n  { activatorEl, activatorEvents }: ReturnType<typeof useActivator>\n) {\n  watch(() => props.activator, (val, oldVal) => {\n    if (oldVal && val !== oldVal) {\n      const activator = getActivator(oldVal)\n      activator && unbindActivatorProps(activator)\n    }\n    if (val) {\n      nextTick(() => bindActivatorProps())\n    }\n  }, { immediate: true })\n\n  watch(() => props.activatorProps, () => {\n    bindActivatorProps()\n  })\n\n  onScopeDispose(() => {\n    unbindActivatorProps()\n  })\n\n  function bindActivatorProps (el = getActivator(), _props = props.activatorProps) {\n    if (!el) return\n\n    Object.entries(activatorEvents.value).forEach(([name, cb]) => {\n      el.addEventListener(name, cb as (e: Event) => void)\n    })\n\n    Object.keys(_props).forEach(k => {\n      if (_props[k] == null) {\n        el.removeAttribute(k)\n      } else {\n        el.setAttribute(k, _props[k])\n      }\n    })\n  }\n\n  function unbindActivatorProps (el = getActivator(), _props = props.activatorProps) {\n    if (!el) return\n\n    Object.entries(activatorEvents.value).forEach(([name, cb]) => {\n      el.removeEventListener(name, cb as (e: Event) => void)\n    })\n\n    Object.keys(_props).forEach(k => {\n      el.removeAttribute(k)\n    })\n  }\n\n  function getActivator (selector = props.activator): HTMLElement | undefined {\n    let activator\n    if (selector) {\n      if (selector === 'parent') {\n        activator = vm?.proxy?.$el?.parentNode\n      } else if (typeof selector === 'string') {\n        // Selector\n        activator = document.querySelector(selector)\n      } else if ('$el' in selector) {\n        // Component (ref)\n        activator = selector.$el\n      } else {\n        // HTMLElement | Element\n        activator = selector\n      }\n    }\n\n    // The activator should only be a valid element (Ignore comments and text nodes)\n    activatorEl.value = activator?.nodeType === Node.ELEMENT_NODE ? activator : null\n\n    return activatorEl.value\n  }\n}\n"]},"metadata":{},"sourceType":"module"}